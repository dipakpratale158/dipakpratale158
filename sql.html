sql

WITH 
    t1 AS (
        SELECT
             COUNT(DISTINCT c14) AS counsler
        FROM
            Receipt_Head_Wise1
        WHERE
            c14 = 'Prachi Anil Ukirde'
    ),
    t2 AS (
        SELECT
            DISTINCT c16, c14
        FROM
            Receipt_Head_Wise1
        WHERE
            c14 = 'Prachi Anil Ukirde'
     
    )
    ,
    t3 as (select c16,
           COUNT(c14) as no_of_amount
           from t2
           group by c16)
           
           SELECT * from t3
           join  t1 on  t1.counsler=t3.no_of_amount

output: c16    no_of_amounth  counsler
        100    1              1



maximum find 
select c14, c19  from Receipt_Head_Wise1
WHERE c19=(SELECT max(c19) FROM Receipt_Head_Wise1)
GROUP BY c14

more than avarage
select c14, count(*) from Receipt_Head_Wise1
WHERE c16>(SELECT avg(c16) FROM Receipt_Head_Wise1)
GROUP BY c14


avg base 
select c14 ,avg(c16) from Receipt_Head_Wise1
WHERE c16>(SELECT avg(c16) FROM Receipt_Head_Wise1)
GROUP BY c14

total  admition 
select c14, COUNT(*) as numberrecipgenrate  
FROM Receipt_Head_Wise1
GROUP BY c14
ORDER BY c14 DESC

bca admision count
select c14, COUNT(*) as numberrecipgenrate  
FROM Receipt_Head_Wise1
WHERE c8='Bachelor Of Commerce-ISBMU'
GROUP BY c14
ORDER BY c14 DESC



maximum recipot done in cource bcom
SELECT c14, c11, c8, c16
FROM Receipt_Head_Wise1
WHERE c8 = 'BCOM-Bachelor of Commerce' 
AND c16 = (SELECT MAX(c16) 
           FROM Receipt_Head_Wise1 
           WHERE c8 = 'BCOM-Bachelor of Commerce');


in counsler name nusrat where less amount recipt done bcom
SELECT c14, c11, c8, c16
FROM Receipt_Head_Wise1
WHERE c8 = 'BCOM-Bachelor of Commerce' AND
c14='Nusrat Zakir Kureshi'
AND c16 = (SELECT min(c16) 
           FROM Receipt_Head_Wise1 
           WHERE c8 = 'BCOM-Bachelor of Commerce' 
          AND c14='Nusrat Zakir Kureshi');

max count using condition
SELECT c14,c16 FROM  Receipt_Head_Wise1  
WHERE c16 in (SELECT c16 FROM Receipt_Head_Wise1 
              GROUP BY c14 HAVING COUNT(*)> 391)


search student name  og vishal sirs count sum same name with all student sum
SELECT c14, sum(c16) FROM Receipt_Head_Wise1 
WHERE c11='FADTARE SOUDAGAR NAVNATH'
GROUP by c14

total amounth of each paitiant
SELECT c11, sum(c16)
over(partition BY c11 ORDER BY c11) as sumofcounslerwise,
avg(c16)
over() as avg_c16
FROM Receipt_Head_Wise1 

top 3 for highest sum
SELECT c11, sum(c16)
over() as total
FROM Receipt_Head_Wise1 
ORDER BY c11 DESC LIMIT 3


counsler amount gerater than avrage  amounth
SELECT c16,c14
FROM Receipt_Head_Wise1  t1
WHERE c16>(SELECT avg(c16)
           FROM Receipt_Head_Wise1 t2
           WHERE t2.c11=t1.c11)
or
         
SELECT * FROM (SELECT *,
               avg(c16) over(partition by c11)
               as avg_counslerramounth FROM Receipt_Head_Wise1) AS subqury
               WHERE c16>avg_counslerramounth

no og occuranses
SELECT c16, COUNT(c16) 
FROM Receipt_Head_Wise1
GROUP BY c16
HAVING COUNT(c16) > 1


most frequly use payment method
SELECT c28,COUNT(*)
FROM Receipt_Head_Wise1
GROUP BY c28
ORDER BY COUNT(*) DESC


most proiffitable course 
SELECT  c8, c11,c14,round(sum(c16),2) as gross
FROM Receipt_Head_Wise1 
ORDER BY gross DESC


MULTIPLE GOUP BASEG SUM 
SELECT c8, c11,c14,sum(c16)
FROM Receipt_Head_Wise1
GROUP BY c8, c11,c14


MOST USE PAYMENT METHOD which bank maximum use
SELECT c14 , 
SUM(CASE WHEN c25='Online Banking' THEN 1 ELSE 0 END)  as "Online Banking",
SUM(CASE WHEN c25='ISBMU Website' THEN 1 ELSE 0 END)  as "ISBMU Website",
SUM(CASE WHEN c25='Cheque' THEN 1 ELSE 0 END)  as "Cheque",
SUM(CASE WHEN c25='IMPS' THEN 1 ELSE 0 END)  as "IMPS",
SUM(CASE WHEN c25='PhonePe' THEN 1 ELSE 0 END)  as "PhonePe",
SUM(CASE WHEN c25='CashDeposited' THEN 1 ELSE 0 END)  as "CashDeposited"
FROM Receipt_Head_Wise1 GROUP BY c14


SELECT round(avg(c8),2) as avg_counsler,
c2 FROM samplevaishnavi2
GROUP BY c8 
ORDER BY avg_counsler DESC


counsler wise count of courses
SELECT c2,c5, count(c8) as totalcountss
FROM samplevaishnavi2
GROUP BY c2,c5
ORDER BY totalcountss DESC

monthwise hihest count
SELECT c6,sum(c8) as total_count FROM samplevaishnavi2
GROUP BY c6
ORDER BY total_count DESC

hihest count month all
SELECT c6,sum(c8) as total_count FROM samplevaishnavi2
GROUP BY c6
HAVING sum(c8) > ( SELECT avg(c8) FROM samplevaishnavi2)



pivote table concept
sum and count of counslerwise 
SELECT
c2,
sum(case WHEN c2='Priti Meghnad' THEN c8 ELSE 0 END) as counslernamepriti,
sum(case WHEN c2='Nusrat Kureshi' THEN c8 ELSE 0 END) as counslernamenusrat,
COUNT(c8) as totalcountofcounsler
FROM samplevaishnavi2
GROUP BY c2
ORDER BY c2

piote base on condition 
SELECT
c4,c2,c5,
sum(case WHEN c2 in ('Priti Meghnad','Nusrat Kureshi') THEN c8 ELSE 0 END) as counslernamepriti,
COUNT(c8) as totalcountofcounsler
FROM samplevaishnavi2
GROUP BY c4,c2
ORDER BY c2



tally using case
SELECT
c1,c4,c2,c5,
sum(case WHEN c2 in ('Priti Meghnad','Nusrat Kureshi') THEN c8 ELSE 0 END) as counslernamepriti,
COUNT(c8) as totalcountofcounsler

FROM samplevaishnavi2
GROUP BY c1,c5
ORDER BY c2

count each
SELECT c2,COUNT(*) as countsofcounsler
FROM samplevaishnavi2
GROUP BY c2

LAST VALUE how work
SELECT c2,
last_value(c2) over(ORDER BY c8)
FROM samplevaishnavi2

last value return all coulum
SELECT c2,
last_value(c2) over(ORDER BY c8 ROWS BETWEEN unbounded preceding AND unbounded following) 
as lastvalue
FROM samplevaishnavi2


Running Total nd
ROWS Clause: Syntax and Options
The purpose of the ROWS clause is to specify the window frame in relation to the current row. The syntax is:

ROWS BETWEEN lower_bound AND upper_bound

The bounds can be any of these five options:

UNBOUNDED PRECEDING – All rows before the current row.
n PRECEDING – n rows before the current row.
CURRENT ROW – Just the current row.
n FOLLOWING – n rows after the current row.
UNBOUNDED FOLLOWING – All rows after the current row.

RUNNING TOTAL range wise if duplicate first count oll and then same
SELECT  c8,
sum(c8) over(ORDER BY c8 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) 
as runningtotal
FROM samplevaishnavi2


or
SELECT C8,
sum(c8) over(ORDER by c8) as runnningtotal
FROM samplevaishnavi2
or
running sum row wise
SELECT c8,
sum(c8) over(ORDER BY c8 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) 
as runningtotal
FROM samplevaishnavi2



average
SELECT c8,
sum(c8) over(ORDER BY c8 ROWS BETWEEN UNBOUNDED PRECEDING AND  UNBOUNDED FOLLOWING) 
as AVARAGE
FROM samplevaishnavi2


SELECT c8,
sum(c8) over(ORDER BY c8 ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) 
as AVARAGE

FROM samplevaishnavi2



GROUPWISE GROUPDESIDER

SELECT c8,C2,
ntile(3) over(PARTITION BY C2 ORDER BY c8) 
as  GROUPSOFSALLARY
FROM samplevaishnavi2


Here are a couple of things to keep in mind when defining window frames with the ROWS clause:

The window frame is evaluated separately within each partition.
The default option depends on if you use ORDER BY:
With ORDER BY, the default frame is RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW.
Without ORDER BY, the default frame is ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING.
If one of your bounds is a current row, you can skip specifying this bound and use a shorter version of the window frame definition:
UNBOUNDED PRECEDING is the same as BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW.
n PRECEDING is the same as BETWEEN n PRECEDING AND CURRENT ROW.
n FOLLOWING is the same as BETWEEN CURRENT ROW AND n FOLLOWING.
UNBOUNDED FOLLOWING is the same as BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING.


give if ele condition like
SELECT c2, IIF(c2='Hafsa Shimayela','male','femail')
FROM samplevaishnavi2




inmysql working
next 10 rows working
SELECT * 
FROM samplevaishnavi2
ORDER BY c2
OFFSET 10 ROWS 
FETCH NEXT 10 ROWS ONLY;

TOP 5 ROW FING IN MYSQL
SELECT TOP 5 * FROM samplevaishnavi2 ORDER BY c8 



datetime
SELECT c11, DATEADD(day, 1, DATEADD(month, 2, DATEADD(year, 2020 - YEAR(c11), c11)))
FROM samplevaishnavi2;



highest amounth in poonam data with rank 1
WITH t1 AS (
    SELECT c14, 
           CAST(CASE WHEN c16='NA' THEN '0' ELSE c16 END as int) as age
    FROM Receipt_Head_Wise1
),
ranking AS (
    SELECT *, 
           RANK() OVER(ORDER BY age DESC) AS rnk
    FROM t1
    WHERE c14='Poonam Anantrao Raut'
)
SELECT * 
FROM ranking 
WHERE rnk=1



top 5 counslers whe done courses that date or online bank throu payment done top 5 emplioy
WITH t1 AS (
    SELECT c14, c8, COUNT(1) AS totalf
    FROM Receipt_Head_Wise1
    WHERE c31 = '24.08/2022'
    GROUP BY c14, c8
  ORDER BY totalf DESC
),
t2 AS (
    SELECT *, DENSE_RANK() OVER (ORDER BY totalf DESC) AS rnk
    FROM t1
)
SELECT c14, c8, totalf
FROM t2
WHERE rnk <= 5;

WHO WON MAXIMUM COUSES
    bcom and bca cources done student list and rank whos maximum courses
    WITH t1 AS (
    SELECT c11, c14,c8, COUNT(1) AS totalf
    FROM Receipt_Head_Wise1
    WHERE c8 in ('BCA-Bachelor of Computer Applications','BCOM-Bachelor of Commerce')
    GROUP BY c11, c14  ORDER BY totalf DESC
),
t2 AS (
    SELECT *, DENSE_RANK() OVER (ORDER BY totalf DESC) AS rnk
    FROM t1
)
SELECT c11, c14, c8,totalf
FROM t2




    delete duplicates
    

select 
c14,c8,c11,count(*) as duplicates

FROM Receipt_Head_Wise1
GROUP BY  c14,c8,c11
HAVING COUNT(*)>=1;
DELETE FROM Receipt_Head_Wise1
WHERE c14 in(SELECT c14 FROM Receipt_Head_Wise1 
             GROUP BY c14
             HAVING COUNT(*) > 1);


    
